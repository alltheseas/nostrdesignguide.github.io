"use strict";(self.webpackChunknostr_design=self.webpackChunknostr_design||[]).push([[352],{7805:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=t(7624),r=t(5788);const s={},a="Private Key Safeguarding",o={id:"how-to/private-key-safeguarding",title:"Private Key Safeguarding",description:"There is no password reset in Nostr. The moment the user leaks their keys, it\u2019s game over and a new npub has to be created.",source:"@site/docs/how-to/private-key-safeguarding.md",sourceDirName:"how-to",slug:"/how-to/private-key-safeguarding",permalink:"/docs/how-to/private-key-safeguarding",draft:!1,unlisted:!1,editUrl:"https://github.com/nostrdesignguide/nostrdesignguide.github.io/tree/main/docs/how-to/private-key-safeguarding.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Onboarding",permalink:"/docs/how-to/onboarding"},next:{title:"Relays",permalink:"/docs/how-to/relays"}},l={},c=[{value:"Preventing Accidental Pasting",id:"preventing-accidental-pasting",level:2},{value:"In summary:",id:"in-summary",level:3},{value:"Preventing leaking to prying eyes",id:"preventing-leaking-to-prying-eyes",level:2},{value:"Preventing phishing and website leaks",id:"preventing-phishing-and-website-leaks",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.MN)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"private-key-safeguarding",children:"Private Key Safeguarding"}),"\n",(0,i.jsx)(n.p,{children:"There is no password reset in Nostr. The moment the user leaks their keys, it\u2019s game over and a new npub has to be created."}),"\n",(0,i.jsx)(n.p,{children:"Due to this drastic departure from the username/password model, we as designers and developers have to consider drastic measures to safeguard users\u2019 accidental key leaking."}),"\n",(0,i.jsx)(n.h2,{id:"preventing-accidental-pasting",children:"Preventing Accidental Pasting"}),"\n",(0,i.jsx)(n.p,{children:"The most obvious way people will likely leak their private keys is by copying / pasting the wrong thing and hitting enter without thinking. Damus (Will) did something clever and looked up the users\u2019 npub based on the pasted nsec and automatically substituted it by tagging the user instead."}),"\n",(0,i.jsxs)(n.p,{children:["Prior to fix, the user would paste an actual nsec:\n",(0,i.jsx)(n.code,{children:"nsec1t0kdnkaey5neuyx3ky22t43r5xpchnzy74sz4lkjl7fgj2k0pvqsqp5vsd"})]}),"\n",(0,i.jsxs)(n.p,{children:["After the fix, the nsec converts to the npub mention:\n",(0,i.jsx)(n.code,{children:"@1qru0vtt:vq8qaeu8"})]}),"\n",(0,i.jsx)(n.p,{children:"Damus also shows a warning when trying to post a note with the private key by detecting the format and displaying a message:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Note contains \u201cnsec1\u201d private key. Are you sure?\nYes, post with private key\nNo\n"})}),"\n",(0,i.jsx)(n.p,{children:"We could go a step further and make an even more stern warning:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Warning! You are about to paste a private key! Doing so will allow everyone access to this account, forever. Are you absolutely sure you wish to proceed? \nNo, get me to safety\nYes, I understand the consequences (in red)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"in-summary",children:"In summary:"}),"\n",(0,i.jsx)(n.admonition,{title:"DON'T:",type:"warning",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Allow people to paste secret keys without any warning"}),"\n",(0,i.jsx)(n.li,{children:"Allow notes to go through with nsecs in them"}),"\n"]})}),"\n",(0,i.jsx)(n.admonition,{title:"DO:",type:"tip",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Display a stern warning that the person is about to share an nsec"}),"\n",(0,i.jsx)(n.li,{children:"Convert the nsec to an npub to prevent accidental sharing while ignoring the warning."}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"preventing-leaking-to-prying-eyes",children:"Preventing leaking to prying eyes"}),"\n",(0,i.jsx)(n.p,{children:"In the legacy world, we allow users to preview their passwords, usually with an eye icon that toggles the visibility of the password."}),"\n",(0,i.jsx)(n.p,{children:"This is NOT advisable UX for private keys. Users are better off not being able to toggle the visibility because keys are not something anyone would type in character by character. A copy button is more useful and guarantees the safekeeping of the private key."}),"\n",(0,i.jsx)(n.p,{children:"It is easy enough to double check that you\u2019re copying the correct private key and not some script-inserted fake key because the your private key should resolve to the public key being displayed."}),"\n",(0,i.jsx)(n.admonition,{title:"DON'T:",type:"warning",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Display private key in full at any point, or even partially"}),"\n",(0,i.jsx)(n.li,{children:"Allow users to reveal their key, even to themselves"}),"\n"]})}),"\n",(0,i.jsx)(n.admonition,{title:"DO:",type:"tip",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add a copy button that copies the key on click"}),"\n",(0,i.jsx)(n.li,{children:"Add a label explaining why the key cannot be revealed (\u201cYour secret key is hidden to keep prying eyes away. Please copy it to a safe location\u201d)."}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"preventing-phishing-and-website-leaks",children:"Preventing phishing and website leaks"}),"\n",(0,i.jsx)(n.p,{children:"It is only a matter of time before phishing scams pop up to steal people\u2019s nsecs. As a community, we have an early opportunity to establish a culture of solid nsec safekeeping by making it clear that allowing nsec pasting in logins is a bad idea."}),"\n",(0,i.jsx)(n.p,{children:"This won\u2019t prevent 100% of phishing scams, but it may save some people from sharing their keys with bad actors."}),"\n",(0,i.jsx)(n.p,{children:"The solution is simple: DO NOT ask for private keys in the login fields. Even though we can\u2019t stop the user from pasting one instead of an npub-only login (without removing the input field entirely), we can discourage them with a message:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"We advise against using private keys for logging in as this may leak your account permanently."})}),"\n",(0,i.jsx)(n.p,{children:"You can get creative with the copy for your own needs."})]})}function h(e={}){const{wrapper:n}={...(0,r.MN)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},5788:(e,n,t)=>{t.d(n,{MN:()=>c});var i=t(1504);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)t=s[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)t=s[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=i.createContext({}),c=function(e){var n=i.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},d={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},h=i.forwardRef((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,h=o(e,["components","mdxType","originalType","parentName"]),p=c(t),u=r,g=p["".concat(l,".").concat(u)]||p[u]||d[u]||s;return t?i.createElement(g,a(a({ref:n},h),{},{components:t})):i.createElement(g,a({ref:n},h))}));h.displayName="MDXCreateElement"}}]);